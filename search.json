[{"path":"https://niklhart.github.io/kldest/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2023 kldest authors Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":[]},{"path":"https://niklhart.github.io/kldest/articles/algorithm-benchmark-10d.html","id":"distributions-and-analytical-kl-divergence","dir":"Articles","previous_headings":"Specification of benchmark scenario","what":"Distributions and analytical KL divergence","title":"Algorithm benchmark in high dimensions","text":"Simulation study design Analytical values Kullback-Leibler divergences test cases:","code":"D <- 10 Sigma <- constDiagMatrix(dim = D, diag = 1, offDiag = 0.999) p <- list(     gaussian_10d = list(         paramTrue   = list(mu = rep(0, D), sigma = Sigma),         paramApprox = list(mu = rep(1, D), sigma = Sigma)     ) ) distributions <- list(     gaussian_10d = list(         samples = function(n, m) {             X <- mvrnorm(n = n,                           mu = p$gaussian_10d$paramTrue$mu,                             Sigma = p$gaussian_10d$paramTrue$sigma)             Y <- mvrnorm(n = m,                           mu = p$gaussian_10d$paramApprox$mu,                           Sigma = p$gaussian_10d$paramApprox$sigma)             list(X = X, Y = Y)         },         q = function(x) mvdnorm(x, mu = p$gaussian_10d$paramApprox$mu,                                  Sigma = p$gaussian_10d$paramApprox$sigma),         kld = kld_gaussian(             mu1    = p$gaussian_10d$paramTrue$mu,             sigma1 = p$gaussian_10d$paramTrue$sigma,             mu2    = p$gaussian_10d$paramApprox$mu,             sigma2 = p$gaussian_10d$paramApprox$sigma)     ) ) vapply(distributions, function(x) x$kld, 1) #> gaussian_10d  #>    0.5004504"},{"path":"https://niklhart.github.io/kldest/articles/algorithm-benchmark-10d.html","id":"simulation-scenarios","dir":"Articles","previous_headings":"Specification of benchmark scenario","what":"Simulation scenarios","title":"Algorithm benchmark in high dimensions","text":"distributions specified , samples different sizes drawn, several replicates per distribution sample size.","code":"samplesize <- 10^(2:4) #n <- c(20,50,100,200,500,1000,2000,5000,10000) nRep       <- 25L  scenarios <- combinations(     distribution = names(distributions),     sample.size  = samplesize,     replicate    = 1:nRep )"},{"path":"https://niklhart.github.io/kldest/articles/algorithm-benchmark-10d.html","id":"algorithms","dir":"Articles","previous_headings":"Specification of benchmark scenario","what":"Algorithms","title":"Algorithm benchmark in high dimensions","text":"following algorithms considered:","code":"algorithms_XY <- list(     nn1_XY   = function(X, Y) kld_est_nn(X, Y),     nn_br_XY = function(X, Y) kld_est_brnn(X, Y, warn.max.k = FALSE) ) algorithms_Xq <- list(     nn1_Xq = function(X, q) kld_est_nn(X, q = q) ) nAlgoXY  <- length(algorithms_XY) nAlgoXq  <- length(algorithms_Xq) nmAlgo   <- c(names(algorithms_XY),names(algorithms_Xq))"},{"path":"https://niklhart.github.io/kldest/articles/algorithm-benchmark-10d.html","id":"run-the-simulation-study","dir":"Articles","previous_headings":"","what":"Run the simulation study","title":"Algorithm benchmark in high dimensions","text":"Post-processing: combine scenarios, kldiv runtime single data frame","code":"# allocating results matrices nscenario  <- nrow(scenarios) runtime <- kld <- matrix(nrow = nscenario,                           ncol = nAlgoXY+nAlgoXq,                           dimnames = list(NULL, nmAlgo))  for (i in 1:nscenario) {      dist <- scenarios$distribution[i]     n    <- scenarios$sample.size[i]          samples <- distributions[[dist]]$sample(n = n, m = n)     X <- samples$X     Y <- samples$Y     q <- distributions[[dist]]$q      # different algorithms are evaluated on the same samples     for (j in 1:nAlgoXY) {         algo         <- algorithms_XY[[j]]         start_time   <- Sys.time()         kld[i,j]     <- algo(X, Y)         end_time     <- Sys.time()         runtime[i,j] <- end_time - start_time     }     for (j in 1:nAlgoXq) {         nj            <- nAlgoXY+j         algo          <- algorithms_Xq[[j]]         start_time    <- Sys.time()         kld[i,nj]     <- algo(X, q)         end_time      <- Sys.time()         runtime[i,nj] <- end_time - start_time     } } tmp1 <- cbind(scenarios, kld) |> melt(measure.vars  = nmAlgo,                                       value.name    = \"kld\",                                       variable.name = \"algorithm\")  tmp2 <- cbind(scenarios, runtime) |> melt(measure.vars  = nmAlgo,                                           value.name    = \"runtime\",                                           variable.name = \"algorithm\")  results <- merge(tmp1,tmp2) results$sample.size <- as.factor(results$sample.size) rm(tmp1,tmp2)"},{"path":[]},{"path":"https://niklhart.github.io/kldest/articles/algorithm-benchmark-10d.html","id":"accuracy-of-kl-divergence-estimators","dir":"Articles","previous_headings":"Graphical display of results","what":"Accuracy of KL divergence estimators","title":"Algorithm benchmark in high dimensions","text":"\\(\\Rightarrow\\) bias-reduced nearest neighbour algorithm shows much better performance either plain 1-nearest neighbour algorithms. particular, even approximate density q known (e.g., model fitted data X), may preferable simulate (large) sample Y \\(Q\\) use bias-reduced algorithm two-sample problem, rather using q.","code":"ggplot(results, aes(x=sample.size, y=kld, color=algorithm)) +      geom_jitter(position=position_dodge(0.5)) +      facet_wrap(\"distribution\", scales = \"free_y\") +     geom_hline(data = data.frame(distribution = names(distributions),                                   kldtrue = vapply(distributions, function(x) x$kld,1)),                 aes(yintercept = kldtrue)) +     xlab(\"Sample sizes\") + ylab(\"KL divergence estimate\") +      ggtitle(\"Accuracy of different algorithms\") +     theme(plot.title = element_text(hjust = 0.5))"},{"path":[]},{"path":"https://niklhart.github.io/kldest/articles/algorithm-benchmark-1d.html","id":"distributions-and-analytical-kl-divergence","dir":"Articles","previous_headings":"Specification of benchmark scenario","what":"Distributions and analytical KL divergence","title":"Algorithm benchmark in 1D","text":"investigate following pairs distributions, analytical KL divergence values known: \\(\\text{Exp}(1)\\) vs. \\(\\text{Exp}(1/12)\\). \\(\\mathcal{N}(0,1)\\) vs. \\(\\mathcal{N}(1,2^2)\\), \\(\\mathcal{U}(1,2)\\) vs. \\(\\mathcal{U}(0,4)\\), Analytical values Kullback-Leibler divergences test cases:","code":"p <- list(     exponential = list(lambda1 = 1, lambda2 = 1/12),     gaussian    = list(mu1 = 0, sigma1 = 1, mu2 = 1, sigma2 = 2^2),     uniform     = list(a1 = 1, b1 = 2, a2 = 0, b2 = 4) ) distributions <- list(     exponential = list(         samples = function(n, m) {             X <- rexp(n, rate = p$exponential$lambda1)             Y <- rexp(m, rate = p$exponential$lambda2)             list(X = X, Y = Y)         },         kld = do.call(kld_exponential, p$exponential)     ),     gaussian = list(         samples = function(n, m) {             X <- rnorm(n, mean = p$gaussian$mu1, sd = sqrt(p$gaussian$sigma1))             Y <- rnorm(m, mean = p$gaussian$mu2, sd = sqrt(p$gaussian$sigma2))             list(X = X, Y = Y)         },         kld = do.call(kld_gaussian, p$gaussian)     ),     uniform = list(          samples = function(n, m) {             X <- runif(n, min = p$uniform$a1, max = p$uniform$b1)             Y <- runif(m, min = p$uniform$a2, max = p$uniform$b2)             list(X = X, Y = Y)         },         kld = do.call(kld_uniform, p$uniform)     ) ) vapply(distributions, function(x) x$kld, 1) #> exponential    gaussian     uniform  #>   1.5682400   0.4431472   1.3862944"},{"path":"https://niklhart.github.io/kldest/articles/algorithm-benchmark-1d.html","id":"simulation-scenarios","dir":"Articles","previous_headings":"Specification of benchmark scenario","what":"Simulation scenarios","title":"Algorithm benchmark in 1D","text":"distributions specified , samples different sizes drawn, several replicates per distribution sample size.","code":"samplesize <- 10^(2:4) nRep       <- 25L  scenarios <- combinations(     distribution = names(distributions),     sample.size  = samplesize,     replicate    = 1:nRep )"},{"path":"https://niklhart.github.io/kldest/articles/algorithm-benchmark-1d.html","id":"algorithms","dir":"Articles","previous_headings":"Specification of benchmark scenario","what":"Algorithms","title":"Algorithm benchmark in 1D","text":"consder following algorithms: kernel density estimation numerical integration (dens_int) kernel density estimation Monte Carlo approximation (dens_mc) 1-nearest neighbour density estimation (nn_1) bias-reduced nearest neighbour density estimation (nn_br)","code":"algorithms <- list(     dens_int = function(X, Y) kld_est_kde1(X = X, Y = Y, MC = FALSE),     dens_mc  = function(X, Y) kld_est_kde1(X = X, Y = Y, MC = TRUE),     nn_1     = kld_est_nn,     nn_br = function(X, Y) kld_est_brnn(X = X, Y = Y, warn.max.k = FALSE) ) nAlgo   <- length(algorithms)"},{"path":"https://niklhart.github.io/kldest/articles/algorithm-benchmark-1d.html","id":"run-the-simulation-study","dir":"Articles","previous_headings":"","what":"Run the simulation study","title":"Algorithm benchmark in 1D","text":"Post-processing: combine scenarios, kldiv1d runtime single data frame","code":"# allocating results matrices nscenario  <- nrow(scenarios) runtime <- kldiv1d <- matrix(nrow = nscenario,                               ncol = nAlgo,                               dimnames = list(NULL, names(algorithms)))  for (i in 1:nscenario) {      dist <- scenarios$distribution[i]     n    <- scenarios$sample.size[i]          samples <- distributions[[dist]]$sample(n = n, m = n)     X <- samples$X     Y <- samples$Y          # different algorithms are evaluated on the same samples     for (j in 1:nAlgo) {         algo <- algorithms[[j]]         start_time <- Sys.time()         kldiv1d[i,j] <- algo(X, Y)         end_time <- Sys.time()         runtime[i,j] <- end_time - start_time     } } tmp1 <- cbind(scenarios, kldiv1d) |> melt(measure.vars = names(algorithms),                                           value.name = \"kld\",                                           variable.name = \"algorithm\")  tmp2 <- cbind(scenarios, runtime) |> melt(measure.vars = names(algorithms),                                           value.name = \"runtime\",                                           variable.name = \"algorithm\")  results <- merge(tmp1,tmp2) results$sample.size <- as.factor(results$sample.size) rm(tmp1,tmp2)"},{"path":[]},{"path":"https://niklhart.github.io/kldest/articles/algorithm-benchmark-1d.html","id":"accuracy-of-kl-divergence-estimators","dir":"Articles","previous_headings":"Results","what":"Accuracy of KL divergence estimators","title":"Algorithm benchmark in 1D","text":"\\(\\Rightarrow\\) estimators converge towards true KL divergence (black solid line). Kernel density-based estimators generally lower variance nearest neighbour-based estimators, show finite sample bias, especially asymmetric exponential distribution. difference 1-nearest neighbour bias-reduced k-nearest neighbour methods terms accuracy.","code":"ggplot(results, aes(x=sample.size, y=kld, color=algorithm)) +      geom_jitter(position=position_dodge(.5)) +      facet_wrap(\"distribution\", scales = \"free_y\") +     geom_hline(data = data.frame(distribution = names(distributions),                                   kldtrue = vapply(distributions, function(x) x$kld,1)),                 aes(yintercept = kldtrue)) +     xlab(\"Sample sizes\") + ylab(\"KL divergence estimate\") +      ggtitle(\"Accuracy of different algorithms\") +     theme(plot.title = element_text(hjust = 0.5)) #> Warning: Removed 10 rows containing missing values (`geom_point()`)."},{"path":"https://niklhart.github.io/kldest/articles/algorithm-benchmark-1d.html","id":"runtime-of-kl-divergence-estimators","dir":"Articles","previous_headings":"Results","what":"Runtime of KL divergence estimators","title":"Algorithm benchmark in 1D","text":"\\(\\Rightarrow\\) Kernel density-based estimators, use stats::density, generally fastest (except small sample sizes). investigated methods scale approximately linearly sample size, due use fast Fourier transform kernel density estimation use kd-tree nearest neighbours search. bias-reduced nearest neighbour estimator nn_br approximately 1 order magnitude slower 1-nearest neighbour estimator nn_1, without offering additional accuracy 1-D examples. extra effort starts pay higher-dimensional problems.","code":"ggplot(results, aes(x=sample.size, y=runtime, color=algorithm)) +      scale_y_log10() +      geom_jitter(position=position_dodge(.5)) +      facet_wrap(\"distribution\", scales = \"free_y\") +     xlab(\"Sample sizes\") + ylab(\"Runtime [sec]\") +      ggtitle(\"Runtime of different algorithms\") +     theme(plot.title = element_text(hjust = 0.5))"},{"path":[]},{"path":"https://niklhart.github.io/kldest/articles/algorithm-benchmark-2d.html","id":"distributions-and-kl-d","dir":"Articles","previous_headings":"Specification of simulation scenario","what":"Distributions and KL-D","title":"Algorithm benchmark in 2D","text":"investigate following pairs distributions, analytical KL divergence values known: \\(\\mathcal{N}\\left(\\begin{pmatrix}0\\\\ 0\\end{pmatrix},\\begin{pmatrix}1 & 0\\\\ 0 & 1\\end{pmatrix}\\right)\\) vs. \\(\\mathcal{N}\\left(\\begin{pmatrix}1\\\\ 1\\end{pmatrix},\\begin{pmatrix}2 & 0\\\\ 0 & 2\\end{pmatrix}\\right)\\) (2D Gaussians, different location/scale, uncorrelated), \\(\\mathcal{N}\\left(\\begin{pmatrix}0\\\\ 0\\end{pmatrix},\\begin{pmatrix}1 & 0.9\\\\ 0.9 & 1\\end{pmatrix}\\right)\\) vs. \\(\\mathcal{N}\\left(\\begin{pmatrix}0\\\\ 0\\end{pmatrix},\\begin{pmatrix}1 & 0.1\\\\ 0.1 & 1\\end{pmatrix}\\right)\\) (2D Gaussians, location/scale, different correlation strength). Analytical values Kullback-Leibler divergences test cases:","code":"p <- list(     indep    = list(mu1 = c(0,0), sigma1 = diag(2),                      mu2 = c(1,1), sigma2 = 2*diag(2)),     corr     = list(mu1 = c(0,0), sigma1 = constDiagMatrix(dim = 2, diag = 1, offDiag = 0.9),                      mu2 = c(0,0), sigma2 = constDiagMatrix(dim = 2, diag = 1, offDiag = 0.1)) ) distributions <- list(     indep = list(         samples = function(n, m) {             X <- MASS::mvrnorm(n = n, mu = p$indep$mu1, Sigma = p$indep$sigma1)             Y <- MASS::mvrnorm(n = m, mu = p$indep$mu2, Sigma = p$indep$sigma2)             list(X = X, Y = Y)         },         kld = do.call(kld_gaussian, p$indep)     ),     corr = list(         samples = function(n, m) {             X <- MASS::mvrnorm(n = n, mu = p$corr$mu1, Sigma = p$corr$sigma1)             Y <- MASS::mvrnorm(n = m, mu = p$corr$mu2, Sigma = p$corr$sigma2)             list(X = X, Y = Y)         },         kld = do.call(kld_gaussian, p$corr)     ) ) kldtrue <- data.frame(distribution = factor(names(distributions),                                              levels = names(distributions),                                             ordered = TRUE),                        kld          = unname(vapply(distributions, function(x) x$kld,1))) kldtrue #>   distribution       kld #> 1        indep 0.6931472 #> 2         corr 0.7445324"},{"path":"https://niklhart.github.io/kldest/articles/algorithm-benchmark-2d.html","id":"simulation-scenarios","dir":"Articles","previous_headings":"Specification of simulation scenario","what":"Simulation scenarios","title":"Algorithm benchmark in 2D","text":"distributions specified , samples different sizes drawn, several replicates per distribution sample size.","code":"samplesize <- 10^(2:5) nRep       <- 25L  scenarios <- combinations(     distribution = names(distributions),     sample.size  = samplesize,     replicate    = 1:nRep )"},{"path":"https://niklhart.github.io/kldest/articles/algorithm-benchmark-2d.html","id":"algorithms","dir":"Articles","previous_headings":"Specification of simulation scenario","what":"Algorithms","title":"Algorithm benchmark in 2D","text":"following algorithms considered:","code":"algorithms <- list(     kde2  = function(X, Y) kld_est_kde2(X = X, Y = Y),     nn_1  = kld_est_nn,     nn_br = function(X, Y) kld_est_brnn(X = X, Y = Y, warn.max.k = FALSE) ) nAlgo   <- length(algorithms)"},{"path":"https://niklhart.github.io/kldest/articles/algorithm-benchmark-2d.html","id":"run-the-simulation-study","dir":"Articles","previous_headings":"","what":"Run the simulation study","title":"Algorithm benchmark in 2D","text":"Post-processing: combine scenarios, kld runtime single data frame Convert factor","code":"# allocating results matrices nscenario  <- nrow(scenarios) runtime <- kld <- matrix(nrow = nscenario,                           ncol = nAlgo,                           dimnames = list(NULL, names(algorithms)))  for (i in 1:nscenario) {      dist <- scenarios$distribution[i]     n    <- scenarios$sample.size[i]          samples <- distributions[[dist]]$sample(n = n, m = n)     X <- samples$X     Y <- samples$Y          # different algorithms are evaluated on the same samples     for (j in 1:nAlgo) {         algo <- algorithms[[j]]         start_time <- Sys.time()         kld[i,j] <- algo(X, Y)         end_time <- Sys.time()         runtime[i,j] <- end_time - start_time     } } tmp1 <- cbind(scenarios, kld) |> melt(measure.vars = names(algorithms),                                       value.name = \"kld\",                                       variable.name = \"algorithm\")  tmp2 <- cbind(scenarios, runtime) |> melt(measure.vars = names(algorithms),                                           value.name = \"runtime\",                                           variable.name = \"algorithm\")  results <- merge(tmp1,tmp2) rm(tmp1,tmp2) results$sample.size <- as.factor(results$sample.size) results$algorithm <- factor(results$algorithm,                              levels = names(algorithms)) results$distribution <- factor(results$distribution,                                 levels = names(distributions),                                 ordered = TRUE)"},{"path":[]},{"path":"https://niklhart.github.io/kldest/articles/algorithm-benchmark-2d.html","id":"accuracy-of-kl-divergence-estimators","dir":"Articles","previous_headings":"Results","what":"Accuracy of KL divergence estimators","title":"Algorithm benchmark in 2D","text":"\\(\\Rightarrow\\) estimators converge towards true KL divergence (black solid line). Whereas nearest neighbour-based estimators unbiased, kernel density-based estimator comparable variance considerable bias smaller samples.","code":"ggplot(results, aes(x=sample.size, y=kld, color=algorithm)) +      geom_jitter(position=position_dodge(.5)) +      facet_wrap(\"distribution\", scales = \"free_y\") +     geom_hline(data = kldtrue, aes(yintercept = kld)) +     xlab(\"Sample sizes\") + ylab(\"KL divergence estimate\") +      ggtitle(\"Accuracy of different algorithms\") +     theme(plot.title = element_text(hjust = 0.5))"},{"path":"https://niklhart.github.io/kldest/articles/algorithm-benchmark-2d.html","id":"runtime-of-kl-divergence-estimators","dir":"Articles","previous_headings":"Results","what":"Runtime of KL divergence estimators","title":"Algorithm benchmark in 2D","text":"\\(\\Rightarrow\\) kernel density-based estimator, use KernSmooth::bkde, 10-fold faster nearest neighbour-based estimators large samples. However also much less precise.","code":"ggplot(results, aes(x=sample.size, y=runtime, color=algorithm)) +      scale_y_log10() +      geom_jitter(position=position_dodge(.5)) +      facet_wrap(\"distribution\", scales = \"free_y\") +     xlab(\"Sample sizes\") + ylab(\"Runtime [sec]\") +      ggtitle(\"Runtime of different algorithms\") +     theme(plot.title = element_text(hjust = 0.5))"},{"path":[]},{"path":"https://niklhart.github.io/kldest/articles/comparison-1sample-2sample-1D.html","id":"distributions-and-analytical-kl-d","dir":"Articles","previous_headings":"Specification of simulation scenario","what":"Distributions and analytical KL-D","title":"Comparing 1- vs. 2-sample estimation in 1-D","text":"investigate following pairs distributions, analytical KL divergence values known: \\(\\text{Exp}(1)\\) vs. \\(\\text{Exp}(1/12)\\), \\(\\mathcal{N}(0,1)\\) vs. \\(\\mathcal{N}(1,2^2)\\), \\(\\mathcal{U}(1,2)\\) vs. \\(\\mathcal{U}(0,4)\\). Analytical values Kullback-Leibler divergences test cases:","code":"p <- list(     exponential = list(lambda1 = 1, lambda2 = 1/12),     gaussian    = list(mu1 = 0, sigma1 = 1, mu2 = 1, sigma2 = 2^2),     uniform     = list(a1 = 1, b1 = 2, a2 = 0, b2 = 4) ) distributions <- list(     exponential = list(         samples = function(n, m) {             X <- rexp(n, rate = p$exponential$lambda1)             Y <- rexp(m, rate = p$exponential$lambda2)             list(X = X, Y = Y)         },         q = function(x) dexp(x, rate = p$exponential$lambda2),         kld = do.call(kld_exponential, p$exponential)     ),     gaussian = list(         samples = function(n, m) {             X <- rnorm(n, mean = p$gaussian$mu1, sd = sqrt(p$gaussian$sigma1))             Y <- rnorm(m, mean = p$gaussian$mu2, sd = sqrt(p$gaussian$sigma2))             list(X = X, Y = Y)         },         q = function(x) dnorm(x, mean = p$gaussian$mu2, sd = sqrt(p$gaussian$sigma2)),         kld = do.call(kld_gaussian, p$gaussian)     ),     uniform = list(          samples = function(n, m) {             X <- runif(n, min = p$uniform$a1, max = p$uniform$b1)             Y <- runif(m, min = p$uniform$a2, max = p$uniform$b2)             list(X = X, Y = Y)         },         q = function(x) dunif(x, min = p$uniform$a2, max = p$uniform$b2),         kld = do.call(kld_uniform, p$uniform)     ) ) vapply(distributions, function(x) x$kld, 1) #> exponential    gaussian     uniform  #>   1.5682400   0.4431472   1.3862944"},{"path":"https://niklhart.github.io/kldest/articles/comparison-1sample-2sample-1D.html","id":"simulation-scenarios","dir":"Articles","previous_headings":"Specification of simulation scenario","what":"Simulation scenarios","title":"Comparing 1- vs. 2-sample estimation in 1-D","text":"distributions specified , samples different sizes drawn, several replicates per distribution sample size.","code":"samplesize <- 10^(2:4) nRep       <- 25L  scenarios <- combinations(     distribution = names(distributions),     sample.size  = samplesize,     replicate    = 1:nRep )"},{"path":"https://niklhart.github.io/kldest/articles/comparison-1sample-2sample-1D.html","id":"algorithms","dir":"Articles","previous_headings":"Specification of simulation scenario","what":"Algorithms","title":"Comparing 1- vs. 2-sample estimation in 1-D","text":"following algorithms considered:","code":"algorithms_XY <- list(     nn_XY     = function(X, Y) kld_est_nn(X, Y) ) algorithms_Xq <- list(     nn_Xq = function(X, q) kld_est_nn(X, q = q) ) nAlgoXY  <- length(algorithms_XY) nAlgoXq  <- length(algorithms_Xq) nmAlgo   <- c(names(algorithms_XY),names(algorithms_Xq))"},{"path":[]},{"path":"https://niklhart.github.io/kldest/articles/comparison-1sample-2sample-1D.html","id":"simulation","dir":"Articles","previous_headings":"Comparison","what":"Simulation","title":"Comparing 1- vs. 2-sample estimation in 1-D","text":"Post-processing: combine scenarios, kld runtime single data frame","code":"# allocating results matrices nscenario  <- nrow(scenarios) runtime <- kld <- matrix(nrow = nscenario,                           ncol = nAlgoXY+nAlgoXq,                           dimnames = list(NULL, nmAlgo))  for (i in 1:nscenario) {      dist <- scenarios$distribution[i]     n    <- scenarios$sample.size[i]          samples <- distributions[[dist]]$sample(n = n, m = n)     X <- samples$X     Y <- samples$Y     q <- distributions[[dist]]$q      # different algorithms are evaluated on the same samples     for (j in 1:nAlgoXY) {         algo         <- algorithms_XY[[j]]         start_time   <- Sys.time()         kld[i,j]     <- algo(X, Y)         end_time     <- Sys.time()         runtime[i,j] <- end_time - start_time     }     for (j in 1:nAlgoXq) {         nj            <- nAlgoXY+j         algo          <- algorithms_Xq[[j]]         start_time    <- Sys.time()         kld[i,nj]     <- algo(X, q)         end_time      <- Sys.time()         runtime[i,nj] <- end_time - start_time     } } tmp1 <- cbind(scenarios, kld) |> melt(measure.vars = nmAlgo,                                       value.name = \"kld\",                                       variable.name = \"algorithm\")  tmp2 <- cbind(scenarios, runtime) |> melt(measure.vars = nmAlgo,                                           value.name = \"runtime\",                                           variable.name = \"algorithm\")  results <- merge(tmp1,tmp2) results$sample.size <- as.factor(results$sample.size) rm(tmp1,tmp2)"},{"path":"https://niklhart.github.io/kldest/articles/comparison-1sample-2sample-1D.html","id":"results-accuracy-of-kl-divergence-estimators","dir":"Articles","previous_headings":"Comparison","what":"Results: Accuracy of KL divergence estimators","title":"Comparing 1- vs. 2-sample estimation in 1-D","text":"\\(\\Rightarrow\\) 1-sample estimation accurate 2-sample estimation three 1-D test cases sample sizes, expected since information available 1-sample case. However, notice bias reduction kld_est_brnn possible 1-sample estimation. Hence, high-dimensional cases density approximate distribution \\(Q\\) available, may preferable simulate (large) sample \\(Q\\) use bias reduction two-sample problem, rather using kld_est_nn 1-sample variant.","code":"ggplot(results, aes(x=sample.size, y=kld, color=algorithm)) +      geom_jitter(position=position_dodge(.5)) +      facet_wrap(\"distribution\", scales = \"free_y\") +     geom_hline(data = data.frame(distribution = names(distributions),                                   kldtrue = vapply(distributions, function(x) x$kld,1)),                 aes(yintercept = kldtrue)) +     xlab(\"Sample sizes\") + ylab(\"KL divergence estimate\") +      ggtitle(\"Accuracy of different algorithms\") +     theme(plot.title = element_text(hjust = 0.5))"},{"path":"https://niklhart.github.io/kldest/articles/uncertainty-quantification.html","id":"simulation-scenarios","dir":"Articles","previous_headings":"","what":"Simulation scenarios","title":"Confidence intervals for KL divergence","text":"distributions specified , samples different sizes drawn, several replicates per distribution sample size.","code":"samplesize <- c(10,100,1000,10000) nRep       <- 100L  scenarios <- combinations(     distribution = names(distributions),     sample.size  = samplesize,     replicate    = 1:nRep )"},{"path":"https://niklhart.github.io/kldest/articles/uncertainty-quantification.html","id":"algorithms-bootstrap-methods","dir":"Articles","previous_headings":"","what":"Algorithms & bootstrap methods","title":"Confidence intervals for KL divergence","text":"following algorithms considered: use subsampling bootstrap:","code":"algorithms <- list(     nn1  = kld_est_nn,     kde1 = kld_est_kde1 ) nAlgo   <- length(algorithms) resampling_method <- \"subsampling\" resampling_fun <- switch(resampling_method,        bootstrap   = kld_ci_bootstrap,        subsampling = function(...) kld_ci_subsampling(..., subsample.size = sqrt) )"},{"path":[]},{"path":"https://niklhart.github.io/kldest/articles/uncertainty-quantification.html","id":"calculation-of-empirical-coverage","dir":"Articles","previous_headings":"Uncertainty quantification of estimators","what":"Calculation of empirical coverage","title":"Confidence intervals for KL divergence","text":"Combine scenarios CI coverage information: Compute coverage per sample size / algorithm / distribution:","code":"# allocating results matrices nscenario  <- nrow(scenarios) covered <- matrix(nrow = nscenario,                    ncol = nAlgo,                    dimnames = list(NULL, names(algorithms)))  # looping over scenarios for (i in 1:nscenario) {      dist <- scenarios$distribution[i]     n    <- scenarios$sample.size[i]          samples <- distributions[[dist]]$sample(n = n, m = n)     kld     <- distributions[[dist]]$kld          X <- samples$X     Y <- samples$Y          # different algorithms are evaluated on the same samples     for (j in 1:nAlgo) {         kldboot <- resampling_fun(X, Y, estimator = algorithms[[j]], B = 500L)         covered[i,j] <- kldboot$ci[1] <= kld && kld <= kldboot$ci[2]     } } results <- cbind(scenarios, covered) |> melt(measure.vars  = names(algorithms),                                              value.name    = \"covered\",                                              variable.name = \"algorithm\") coverage <- dcast(results,                    sample.size + algorithm + distribution ~ .,                    value.var = \"covered\",                    fun.aggregate = function(x) mean(x, na.rm = TRUE)) names(coverage)[4] <- \"coverage\""},{"path":"https://niklhart.github.io/kldest/articles/uncertainty-quantification.html","id":"results-coverage-of-confidence-intervals-for-kl-divergence","dir":"Articles","previous_headings":"Uncertainty quantification of estimators","what":"Results: coverage of confidence intervals for KL divergence","title":"Confidence intervals for KL divergence","text":"\\(\\Rightarrow\\) coverage confidence intervals based nearest neighbour density estimation approaches nominal coverage 95% increasing sample sizes. Gaussian case, kernel density based method performs well estimation benchmark, also holds kernel density method. However, due bias estimating KL divergence exponential uniform distributions, uncertainty quantification also fails. using bootstrapping instead subsampling, results similar kernel density estimation, change dramatically nearest neighbour density estimation, deal ties produced resampling replacement.","code":"ggplot(coverage, aes(x = sample.size, y = coverage, color = algorithm)) +      facet_wrap(\"distribution\") +     geom_line() +      scale_x_log10() +     geom_hline(yintercept = 0.95, lty = 2) +      ggtitle(paste(\"Resampling method:\",resampling_method)) +     theme(plot.title = element_text(hjust = 0.5))"},{"path":"https://niklhart.github.io/kldest/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Niklas Hartung. Author, maintainer, copyright holder.","code":""},{"path":"https://niklhart.github.io/kldest/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Hartung N (2023). kldest: Sample-based estimation Kullback-Leibler divergence. R package version 0.1.0.9001, https://niklhart.github.io/kldest/.","code":"@Manual{,   title = {kldest: Sample-based estimation of Kullback-Leibler divergence},   author = {Niklas Hartung},   year = {2023},   note = {R package version 0.1.0.9001},   url = {https://niklhart.github.io/kldest/}, }"},{"path":"https://niklhart.github.io/kldest/index.html","id":"kldest-kullback-leibler-divergence-estimation","dir":"","previous_headings":"","what":"Sample-based estimation of Kullback-Leibler divergence","title":"Sample-based estimation of Kullback-Leibler divergence","text":"goal kldest estimate Kullback-Leibler (KL) divergence DKL(P||Q) two probability distributions P Q based : sample x1, ..., xn P probability density q Q, samples x1, ..., xn P y1, ..., ym Q. distributions P Q may uni- multivariate, may discrete, continuous mixed discrete/continuous. Different estimation algorithms provided continuous distributions, either based nearest neighbour density estimation kernel density estimation. Confidence intervals KL divergence can also computed, either via subsampling (preferred) bootstrapping.","code":""},{"path":"https://niklhart.github.io/kldest/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Sample-based estimation of Kullback-Leibler divergence","text":"can install development version kldest GitHub :","code":"# install.packages(\"devtools\") devtools::install_github(\"niklhart/kldest\")"},{"path":"https://niklhart.github.io/kldest/index.html","id":"a-minimal-example-for-kl-divergence-estimation","dir":"","previous_headings":"","what":"A minimal example for KL divergence estimation","title":"Sample-based estimation of Kullback-Leibler divergence","text":"KL divergence estimation based nearest neighbour density estimates flexible approach.","code":"library(kldest)"},{"path":"https://niklhart.github.io/kldest/index.html","id":"kl-divergence-between-1-d-gaussians","dir":"","previous_headings":"A minimal example for KL divergence estimation","what":"KL divergence between 1-D Gaussians","title":"Sample-based estimation of Kullback-Leibler divergence","text":"Analytical KL divergence: Estimate based two samples Gaussians: Estimate based sample first Gaussian density second: Uncertainty quantification via subsampling:","code":"kld_gaussian(mu1 = 0, sigma1 = 1, mu2 = 1, sigma2 = 2^2) #> [1] 0.4431472 X <- rnorm(100) Y <- rnorm(100, mean = 1, sd = 2) kld_est_nn(X, Y) #> [1] 0.630473 q <- function(x) dnorm(x, mean = 1, sd =2) kld_est_nn(X, q = q) #> [1] 0.3904603 kld_ci_subsampling(X, q = q)$ci #>       2.5%      97.5%  #> 0.06544115 0.65278508"},{"path":"https://niklhart.github.io/kldest/index.html","id":"kl-divergence-between-2-d-gaussians","dir":"","previous_headings":"A minimal example for KL divergence estimation","what":"KL divergence between 2-D Gaussians","title":"Sample-based estimation of Kullback-Leibler divergence","text":"Analytical KL divergence uncorrelated correlated Gaussian: Estimate based two samples Gaussians:","code":"kld_gaussian(mu1 = rep(0,2), sigma1 = diag(2),              mu2 = rep(0,2), sigma2 = matrix(c(1,1,1,2),nrow=2)) #> [1] 0.5 X1 <- rnorm(100) X2 <- rnorm(100) Y1 <- rnorm(100) Y2 <- Y1 + rnorm(100) X <- cbind(X1,X2) Y <- cbind(Y1,Y2)  kld_est_nn(X, Y) #> [1] 0.2497069"},{"path":"https://niklhart.github.io/kldest/reference/combinations.html","id":null,"dir":"Reference","previous_headings":"","what":"Combinations of input arguments — combinations","title":"Combinations of input arguments — combinations","text":"Combinations input arguments","code":""},{"path":"https://niklhart.github.io/kldest/reference/combinations.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Combinations of input arguments — combinations","text":"","code":"combinations(...)"},{"path":"https://niklhart.github.io/kldest/reference/combinations.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Combinations of input arguments — combinations","text":"... number atomic vectors.","code":""},{"path":"https://niklhart.github.io/kldest/reference/combinations.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Combinations of input arguments — combinations","text":"data frame columns named inputs, containing input combinations.","code":""},{"path":"https://niklhart.github.io/kldest/reference/combinations.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Combinations of input arguments — combinations","text":"","code":"combinations(a = 1:2, b = letters[1:3], c = LETTERS[1:2]) #>    a b c #> 1  1 a A #> 2  2 a A #> 3  1 b A #> 4  2 b A #> 5  1 c A #> 6  2 c A #> 7  1 a B #> 8  2 a B #> 9  1 b B #> 10 2 b B #> 11 1 c B #> 12 2 c B"},{"path":"https://niklhart.github.io/kldest/reference/constDiagMatrix.html","id":null,"dir":"Reference","previous_headings":"","what":"Constant plus diagonal matrix — constDiagMatrix","title":"Constant plus diagonal matrix — constDiagMatrix","text":"Specify matrix constant values diagonal -diagonals. matrices can used vary degree dependency covariate matrices, example evaluating accuracy KL-divergence estimation algorithms.","code":""},{"path":"https://niklhart.github.io/kldest/reference/constDiagMatrix.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Constant plus diagonal matrix — constDiagMatrix","text":"","code":"constDiagMatrix(dim = 1, diag = 1, offDiag = 0)"},{"path":"https://niklhart.github.io/kldest/reference/constDiagMatrix.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Constant plus diagonal matrix — constDiagMatrix","text":"dim Dimension diag Value diagonal offDiag Value -diagonals","code":""},{"path":"https://niklhart.github.io/kldest/reference/constDiagMatrix.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Constant plus diagonal matrix — constDiagMatrix","text":"dim--dim matrix","code":""},{"path":"https://niklhart.github.io/kldest/reference/constDiagMatrix.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Constant plus diagonal matrix — constDiagMatrix","text":"","code":"constDiagMatrix(dim = 3, diag = 1, offDiag = 0.9) #>      [,1] [,2] [,3] #> [1,]  1.0  0.9  0.9 #> [2,]  0.9  1.0  0.9 #> [3,]  0.9  0.9  1.0"},{"path":"https://niklhart.github.io/kldest/reference/is_two_sample.html","id":null,"dir":"Reference","previous_headings":"","what":"Detect if a one- or two-sample problem is specified — is_two_sample","title":"Detect if a one- or two-sample problem is specified — is_two_sample","text":"Detect one- two-sample problem specified","code":""},{"path":"https://niklhart.github.io/kldest/reference/is_two_sample.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Detect if a one- or two-sample problem is specified — is_two_sample","text":"","code":"is_two_sample(Y, q)"},{"path":"https://niklhart.github.io/kldest/reference/is_two_sample.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Detect if a one- or two-sample problem is specified — is_two_sample","text":"Y vector, matrix, data frame NULL q function NULL.","code":""},{"path":"https://niklhart.github.io/kldest/reference/is_two_sample.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Detect if a one- or two-sample problem is specified — is_two_sample","text":"TRUE two-sample problem (.e., Y non-null q = NULL) FALSE one-sample problem (.e., Y = NULL q non-null).","code":""},{"path":"https://niklhart.github.io/kldest/reference/kld_ci_bootstrap.html","id":null,"dir":"Reference","previous_headings":"","what":"Uncertainty of KL divergence estimate using Efron's bootstrap. — kld_ci_bootstrap","title":"Uncertainty of KL divergence estimate using Efron's bootstrap. — kld_ci_bootstrap","text":"function computes confidence interval KL divergence based Efron's bootstrap. approach works kernel density-based estimators since nearest neighbour-based estimators deal ties produced sampling replacement.","code":""},{"path":"https://niklhart.github.io/kldest/reference/kld_ci_bootstrap.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Uncertainty of KL divergence estimate using Efron's bootstrap. — kld_ci_bootstrap","text":"","code":"kld_ci_bootstrap(X, Y, estimator = kld_est_kde1, B = 500L, alpha = 0.05)"},{"path":"https://niklhart.github.io/kldest/reference/kld_ci_bootstrap.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Uncertainty of KL divergence estimate using Efron's bootstrap. — kld_ci_bootstrap","text":"X, Y n--d m--d matrices, representing n samples true distribution \\(P\\) m samples approximate distribution \\(Q\\), d dimensions. Vector input treated column matrix. estimator function expecting two inputs X Y, Kullback-Leibler divergence estimation method. Defaults kld_est_kde1, can deal one-dimensional two-sample problems (.e., d = 1 q = NULL). B Number bootstrap replicates (default: 500), larger, accurate, also computationally expensive. alpha Error level, defaults 0.05.","code":""},{"path":"https://niklhart.github.io/kldest/reference/kld_ci_bootstrap.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Uncertainty of KL divergence estimate using Efron's bootstrap. — kld_ci_bootstrap","text":"list fields \"est\" (estimated KL divergence), \"boot\" (length B numeric vector KL divergence estimates bootstrap samples), \"ci\" (length 2 vector containing lower upper limits estimated confidence interval).","code":""},{"path":"https://niklhart.github.io/kldest/reference/kld_ci_bootstrap.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Uncertainty of KL divergence estimate using Efron's bootstrap. — kld_ci_bootstrap","text":"Reference: Efron, \"Bootstrap Methods: Another Look Jackknife\", Annals Statistics, Vol. 7, . 1 (1979).","code":""},{"path":"https://niklhart.github.io/kldest/reference/kld_ci_bootstrap.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Uncertainty of KL divergence estimate using Efron's bootstrap. — kld_ci_bootstrap","text":"","code":"# 1D Gaussian, two samples X <- rnorm(100) Y <- rnorm(100, mean = 1, sd = 2) kld_gaussian(mu1 = 0, sigma1 = 1, mu2 = 1, sigma2 = 2^2) #> [1] 0.4431472 kld_est_kde1(X, Y) #> [1] 0.3791033 kld_ci_bootstrap(X, Y) #> $est #> [1] 0.3791033 #>  #> $boot #>   [1] 0.5060680 0.3592553 0.3788807 0.3895601 0.5686834 0.3912618 0.4165747 #>   [8] 0.4156991 0.4184109 0.4211983 0.5147655 0.4560459 0.2923535 0.5610470 #>  [15] 0.4011535 0.4204951 0.4395196 0.3484123 0.4835059 0.3219016 0.5033275 #>  [22] 0.4537540 0.3496277 0.5290075 0.3114643 0.3943844 0.4973195 0.3915794 #>  [29] 0.3099958 0.3910801 0.3535309 0.3648370 0.3957915 0.4010650 0.3599969 #>  [36] 0.3382696 0.2944053 0.4467984 0.4018490 0.4125690 0.5322621 0.3355014 #>  [43] 0.2917067 0.3163182 0.4328579 0.4885382 0.4584021 0.6985732 0.3311069 #>  [50] 0.6012472 0.4129849 0.3458734 0.4561772 0.5042241 0.3346943 0.5379910 #>  [57] 0.2405344 0.4314732 0.3471461 0.4464980 0.4453814 0.3803608 0.3036103 #>  [64] 0.2346441 0.4416357 0.3341583 0.3205120 0.3487911 0.3520064 0.3618340 #>  [71] 0.4449855 0.5336197 0.3856083 0.5185518 0.3648097 0.2863900 0.3611754 #>  [78] 0.5086304 0.3746059 0.3619653 0.3852158 0.5299101 0.2728872 0.3332784 #>  [85] 0.4035171 0.2513046 0.4517366 0.5677504 0.4530967 0.5526383 0.5123424 #>  [92] 0.3021943 0.3222269 0.3373485 0.2978963 0.3873833 0.5516632 0.5536066 #>  [99] 0.4551016 0.3982381 0.2897276 0.5199056 0.3449936 0.3658607 0.3223468 #> [106] 0.3736659 0.3994572 0.4275627 0.3137106 0.4282616 0.4531168 0.2747338 #> [113] 0.3992332 0.5530073 0.4000408 0.3461744 0.3153912 0.4770003 0.2590209 #> [120] 0.4343036 0.5174198 0.3198229 0.2460182 0.4581209 0.2993521 0.5097157 #> [127] 0.4844610 0.4631384 0.5124236 0.6340803 0.4018550 0.2902932 0.4280462 #> [134] 0.6152166 0.3966701 0.3793719 0.3822278 0.3449775 0.4963790 0.3246793 #> [141] 0.4463989 0.4234274 0.5178542 0.4643093 0.3867586 0.5440943 0.2863590 #> [148] 0.4677065 0.3552903 0.3359423 0.4196872 0.4528569 0.4271340 0.6077648 #> [155] 0.5380388 0.4088673 0.3274988 0.4514663 0.3863051 0.4065918 0.3751445 #> [162] 0.4061782 0.4067250 0.2781887 0.2891607 0.3945214 0.5778720 0.4819475 #> [169] 0.4982036 0.5270806 0.5540480 0.3572721 0.3020169 0.5393260 0.3739013 #> [176] 0.4050029 0.3439899 0.4653192 0.5267463 0.4953196 0.4443140 0.3153219 #> [183] 0.4037560 0.3996594 0.3768097 0.2613784 0.3858085 0.3291854 0.3948871 #> [190] 0.4001886 0.3479999 0.4395885 0.5850830 0.4226801 0.3644174 0.4743590 #> [197] 0.5488124 0.2870582 0.2947869 0.3973934 0.5072957 0.3164088 0.7341948 #> [204] 0.4470659 0.3520857 0.4546270 0.2589167 0.3231022 0.1974769 0.5164012 #> [211] 0.3285715 0.3586879 0.3164546 0.4917372 0.3356996 0.4278611 0.4632654 #> [218] 0.5107901 0.3763245 0.4656260 0.3674734 0.4392479 0.3933808 0.4441893 #> [225] 0.4199006 0.5738827 0.4381766 0.3478143 0.3380459 0.2997324 0.2500892 #> [232] 0.4082583 0.3711235 0.3334669 0.2766102 0.4441805 0.4140142 0.2693607 #> [239] 0.5402828 0.3630536 0.3208372 0.5280066 0.2825821 0.4390251 0.4228528 #> [246] 0.3606491 0.4655516 0.5063691 0.3919932 0.4213541 0.4164913 0.5296016 #> [253] 0.4338314 0.5878126 0.6248431 0.3996677 0.4415894 0.5421230 0.2682908 #> [260] 0.3090686 0.4893528 0.3627640 0.4030292 0.5627713 0.3809428 0.3899007 #> [267] 0.4520793 0.7672843 0.4486329 0.4268895 0.4688938 0.4273345 0.4560938 #> [274] 0.5404133 0.4842226 0.3735121 0.3303667 0.3851554 0.3158457 0.4264886 #> [281] 0.3861776 0.4894595 0.3719229 0.4574712 0.4987879 0.5540479 0.3026744 #> [288] 0.5102960 0.3519650 0.5352954 0.3468667 0.3624001 0.4265423 0.4948367 #> [295] 0.4426639 0.4318020 0.4100731 0.3035105 0.3319305 0.3169077 0.4457597 #> [302] 0.4893575 0.3494909 0.4858125 0.4767465 0.5518787 0.3511816 0.4192355 #> [309] 0.3410706 0.3599394 0.3911657 0.4597200 0.5018023 0.3878608 0.2667048 #> [316] 0.4024474 0.4512126 0.4425140 0.4786447 0.2749187 0.5718645 0.4366868 #> [323] 0.3630032 0.3243263 0.4617371 0.4164202 0.4529374 0.3956937 0.3840234 #> [330] 0.2250918 0.4785311 0.3943423 0.4369047 0.3832801 0.4297790 0.3257723 #> [337] 0.4013776 0.3039717 0.4465032 0.3102126 0.4687282 0.3592113 0.5635191 #> [344] 0.2883595 0.4146681 0.5353053 0.3852612 0.4481122 0.3654820 0.3634313 #> [351] 0.3591503 0.2970784 0.6233077 0.5662353 0.2352708 0.3991276 0.4875068 #> [358] 0.5901749 0.4311555 0.4045074 0.3400652 0.4192092 0.4844490 0.4626257 #> [365] 0.4007285 0.5806132 0.3509813 0.4124620 0.4757417 0.4346992 0.6757628 #> [372] 0.3404724 0.3887860 0.4564366 0.6138122 0.4032174 0.4622400 0.5020301 #> [379] 0.2939165 0.4150349 0.2979363 0.6297061 0.3925707 0.4496997 0.3680232 #> [386] 0.4838023 0.3292414 0.4568737 0.3070538 0.4477645 0.5978220 0.2290516 #> [393] 0.2828254 0.4271702 0.3889670 0.5162677 0.4679415 0.3772808 0.3535018 #> [400] 0.3994449 0.3398305 0.3684976 0.3644334 0.4536294 0.4113601 0.5566794 #> [407] 0.3362904 0.5509902 0.6354077 0.3479355 0.3455710 0.4585233 0.3754328 #> [414] 0.4639208 0.3245151 0.4571868 0.5712259 0.5090038 0.3078260 0.4246364 #> [421] 0.4825315 0.4608155 0.4515429 0.4127932 0.4238832 0.4935994 0.4682381 #> [428] 0.3262372 0.3170216 0.5841481 0.4124721 0.3771218 0.3693960 0.3593402 #> [435] 0.4941665 0.2966438 0.4002823 0.3611427 0.3215003 0.5487813 0.4228256 #> [442] 0.4877893 0.4298332 0.3604756 0.3199054 0.3955809 0.4366144 0.3960948 #> [449] 0.4345915 0.4675469 0.5530325 0.5151241 0.5368402 0.3688296 0.6583483 #> [456] 0.4596051 0.3148708 0.4170082 0.4583655 0.3556703 0.5465161 0.3175326 #> [463] 0.4181564 0.3411166 0.3792849 0.4101959 0.4644458 0.4459723 0.3556747 #> [470] 0.4094010 0.4151160 0.3969553 0.3940527 0.4444670 0.3313391 0.6494921 #> [477] 0.3717014 0.5515117 0.4783745 0.4964218 0.3261996 0.3436425 0.4867807 #> [484] 0.3456440 0.2787862 0.3000979 0.4412230 0.3692230 0.3178508 0.4792630 #> [491] 0.4553160 0.5408452 0.4631215 0.3144334 0.3615180 0.4327527 0.3305170 #> [498] 0.3992053 0.4555085 0.4120912 #>  #> $ci #>     97.5%      2.5%  #> 0.1472669 0.4907484  #>"},{"path":"https://niklhart.github.io/kldest/reference/kld_ci_subsampling.html","id":null,"dir":"Reference","previous_headings":"","what":"Uncertainty of KL divergence estimate using Politis/Romano's subsampling bootstrap. — kld_ci_subsampling","title":"Uncertainty of KL divergence estimate using Politis/Romano's subsampling bootstrap. — kld_ci_subsampling","text":"function computes confidence interval KL divergence based subsampling bootstrap Politis Romano. calculated interval asymptotic coverage \\(1 - \\alpha\\) long \\(b_n/n\\rightarrow 0\\), \\(b_n\\rightarrow\\infty\\) \\(\\frac{\\tau_b}{\\tau_n}\\rightarrow 0\\).","code":""},{"path":"https://niklhart.github.io/kldest/reference/kld_ci_subsampling.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Uncertainty of KL divergence estimate using Politis/Romano's subsampling bootstrap. — kld_ci_subsampling","text":"","code":"kld_ci_subsampling(   X,   Y = NULL,   q = NULL,   estimator = kld_est_nn,   B = 500L,   alpha = 0.05,   subsample.size = function(x) x^(2/3),   convergence.rate = sqrt )"},{"path":"https://niklhart.github.io/kldest/reference/kld_ci_subsampling.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Uncertainty of KL divergence estimate using Politis/Romano's subsampling bootstrap. — kld_ci_subsampling","text":"X, Y n--d m--d matrices, representing n samples true distribution \\(P\\) m samples approximate distribution \\(Q\\), d dimensions. Vector input treated column matrix. Y can left blank q specified (see ). q density function approximate distribution \\(Q\\). Either Y q must specified. estimator Kullback-Leibler divergence estimation method; function expecting two inputs (X Y q, depending arguments provided). Defaults kld_est_nn. B Number bootstrap replicates (default: 500), larger, accurate, also computationally expensive. alpha Error level, defaults 0.05. subsample.size function specifying size subsamples, defaults \\(f(x) = x^{2/3}\\). convergence.rate function computing convergence rate estimator function sample sizes. Defaults \\(f(x) = x^{1/2}\\).","code":""},{"path":"https://niklhart.github.io/kldest/reference/kld_ci_subsampling.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Uncertainty of KL divergence estimate using Politis/Romano's subsampling bootstrap. — kld_ci_subsampling","text":"list fields \"est\" (estimated KL divergence), \"boot\" (length B numeric vector KL divergence estimates bootstrap subsamples), \"ci\" (length 2 vector containing lower upper limits estimated confidence interval).","code":""},{"path":"https://niklhart.github.io/kldest/reference/kld_ci_subsampling.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Uncertainty of KL divergence estimate using Politis/Romano's subsampling bootstrap. — kld_ci_subsampling","text":"Reference: Politis Romano, \"Large sample confidence regions based subsamples minimal assumptions\", Annals Statistics, Vol. 22, . 4 (1994).","code":""},{"path":"https://niklhart.github.io/kldest/reference/kld_ci_subsampling.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Uncertainty of KL divergence estimate using Politis/Romano's subsampling bootstrap. — kld_ci_subsampling","text":"","code":"# 1D Gaussian (one- and two-sample problems) X <- rnorm(100) Y <- rnorm(100, mean = 1, sd = 2) q <- function(x) dnorm(x, mean =1, sd = 2) kld_gaussian(mu1 = 0, sigma1 = 1, mu2 = 1, sigma2 = 2^2) #> [1] 0.4431472 kld_est_nn(X, Y = Y) #> [1] 0.6942589 kld_est_nn(X, q = q) #> [1] 0.7165976 kld_ci_subsampling(X, Y)$ci #>      2.5%     97.5%  #> 0.2976328 1.1713685  kld_ci_subsampling(X, q = q)$ci #>      2.5%     97.5%  #> 0.3759336 1.0595422"},{"path":"https://niklhart.github.io/kldest/reference/kld_discrete.html","id":null,"dir":"Reference","previous_headings":"","what":"Analytical KL divergence for two discrete distributions — kld_discrete","title":"Analytical KL divergence for two discrete distributions — kld_discrete","text":"Analytical KL divergence two discrete distributions","code":""},{"path":"https://niklhart.github.io/kldest/reference/kld_discrete.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Analytical KL divergence for two discrete distributions — kld_discrete","text":"","code":"kld_discrete(P, Q)"},{"path":"https://niklhart.github.io/kldest/reference/kld_discrete.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Analytical KL divergence for two discrete distributions — kld_discrete","text":"P, Q Numerical arrays dimensions, representing discrete probability distributions","code":""},{"path":"https://niklhart.github.io/kldest/reference/kld_discrete.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Analytical KL divergence for two discrete distributions — kld_discrete","text":"scalar (Kullback-Leibler divergence)","code":""},{"path":"https://niklhart.github.io/kldest/reference/kld_discrete.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Analytical KL divergence for two discrete distributions — kld_discrete","text":"","code":"# 1-D example P <- 1:4/10 Q <- rep(0.25,4) kld_discrete(P,Q) #> [1] 0.1064401  # The above example in 2-D P <- matrix(1:4/10,nrow=2) Q <- matrix(0.25,nrow=2,ncol=2) kld_discrete(P,Q) #> [1] 0.1064401"},{"path":"https://niklhart.github.io/kldest/reference/kld_est.html","id":null,"dir":"Reference","previous_headings":"","what":"Kullback-Leibler divergence estimator for discrete, continuous or mixed data. — kld_est","title":"Kullback-Leibler divergence estimator for discrete, continuous or mixed data. — kld_est","text":"two mixed continuous/discrete distributions densities \\(p\\) \\(q\\), denoting \\(x = (x_\\text{c},x_\\text{d})\\), Kullback-Leibler divergence \\(D_{KL}(p||q)\\) given $$D_{KL}(p||q) = \\sum_{x_d} \\int p(x_c,x_d) \\log\\left(\\frac{p(x_c,x_d)}{q(x_c,x_d)}\\right)dx_c.$$ Conditioning discrete variables \\(x_d\\), can re-written $$D_{KL}(p||q) = \\sum_{x_d} p(x_d) D_{KL}\\big(p(\\cdot|x_d)||q(\\cdot|x_d)\\big) + D_{KL}\\big(p_{x_d}||q_{x_d}\\big).$$ , terms $$D_{KL}\\big(p(\\cdot|x_d)||q(\\cdot|x_d)\\big)$$ approximated via nearest neighbour- kernel-based density estimates datasets X Y stratified discrete variables, $$D_{KL}\\big(p_{x_d}||q_{x_d}\\big)$$ approximated using relative frequencies.","code":""},{"path":"https://niklhart.github.io/kldest/reference/kld_est.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Kullback-Leibler divergence estimator for discrete, continuous or mixed data. — kld_est","text":"","code":"kld_est(   X,   Y = NULL,   q = NULL,   estimator.continuous = kld_est_nn,   estimator.discrete = kld_est_discrete,   vartype = NULL )"},{"path":"https://niklhart.github.io/kldest/reference/kld_est.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Kullback-Leibler divergence estimator for discrete, continuous or mixed data. — kld_est","text":"X, Y Data frames matrices number columns d (multivariate samples), numeric/character vectors (univariate samples, .e. d=1), representing n samples true distribution \\(P\\) m samples approximate distribution \\(Q\\), d dimensions. Y can left blank q specified (see ). q density function approximate distribution \\(Q\\). Either Y q must specified. general, q must given decomposed form, \\(q(y_c|y_d)q(y_d)\\), specified named list field cond conditional density \\(q(y_c|y_d)\\) (function expects two arguments y_c y_d) disc discrete marginal density \\(q(y_d)\\) (function expects one argument y_d). possible, may preferable simulate large sample \\(Q\\) use two-sample syntax instead. compatibility continuous discrete one-sample estimators, sample(s) /continuous discrete, instead specifying q length 2 list, may also given function handle computing continous discrete density. estimator.continuous, estimator.discrete KL divergence estimators continuous discrete data, respectively. function two arguments X Y X q, depending whether two-sample one-sample problem considered. Defaults kld_est_nn kld_est_discrete, respectively. vartype length d character vector, vartype[] = \"c\" meaning -th variable continuous, vartype[] = \"d\" meaning discrete. unspecified, vartype \"c\" numeric columns \"d\" character factor columns. default work levels discrete variables encoded using numbers (e.g., 0 females 1 males) count data.","code":""},{"path":"https://niklhart.github.io/kldest/reference/kld_est.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Kullback-Leibler divergence estimator for discrete, continuous or mixed data. — kld_est","text":"scalar, estimated Kullback-Leibler divergence \\(\\hat D_{KL}(P||Q)\\).","code":""},{"path":"https://niklhart.github.io/kldest/reference/kld_est.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Kullback-Leibler divergence estimator for discrete, continuous or mixed data. — kld_est","text":"","code":"# 2D example, two samples X <- data.frame(cont  = rnorm(10),                 discr = c(rep('a',4),rep('b',6))) Y <- data.frame(cont  = c(rnorm(5), rnorm(5, sd = 2)),                 discr = c(rep('a',5),rep('b',5))) kld_est(X, Y) #> [1] -0.4226458  # 2D example, one sample X <- data.frame(cont  = rnorm(10),                 discr = c(rep(0,4),rep(1,6))) q <- list(cond = function(xc,xd) dnorm(xc, mean = xd, sd = 1),           disc = function(xd) dbinom(xd, size = 1, prob = 0.5)) kld_est(X, q = q, vartype = c(\"c\",\"d\")) #> [1] 0.05195"},{"path":"https://niklhart.github.io/kldest/reference/kld_est_brnn.html","id":null,"dir":"Reference","previous_headings":"","what":"Bias-reduced generalized k-nearest-neighbour KL divergence estimation — kld_est_brnn","title":"Bias-reduced generalized k-nearest-neighbour KL divergence estimation — kld_est_brnn","text":"bias-reduced generalized k-NN based KL divergence estimator Wang et al. (2009) specified Eq.(29).","code":""},{"path":"https://niklhart.github.io/kldest/reference/kld_est_brnn.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Bias-reduced generalized k-nearest-neighbour KL divergence estimation — kld_est_brnn","text":"","code":"kld_est_brnn(X, Y, max.k = 100, warn.max.k = TRUE, eps = 0)"},{"path":"https://niklhart.github.io/kldest/reference/kld_est_brnn.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Bias-reduced generalized k-nearest-neighbour KL divergence estimation — kld_est_brnn","text":"X, Y n--d m--d matrices, representing n samples true distribution \\(P\\) m samples approximate distribution \\(Q\\), d dimensions. Vector input treated column matrix. Y can left blank q specified (see ). max.k Maximum numbers nearest neighbours compute (default: 100). larger max.k may yield accurate KL-D estimate (see warn.max.k), always increase computational cost. warn.max.k TRUE (default), warns max.k max.k neighbours within neighbourhood \\(\\delta\\) data point(s). case, first max.k neighbours counted. consequence, max.k may required increased. eps Error bound nearest neighbour search. value eps = 0 (default) implies exact nearest neighbour search, eps > 0 approximate nearest neighbours sought, may somewhat faster high-dimensional problems.","code":""},{"path":"https://niklhart.github.io/kldest/reference/kld_est_brnn.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Bias-reduced generalized k-nearest-neighbour KL divergence estimation — kld_est_brnn","text":"scalar, estimated Kullback-Leibler divergence \\(\\hat D_{KL}(P||Q)\\).","code":""},{"path":"https://niklhart.github.io/kldest/reference/kld_est_brnn.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Bias-reduced generalized k-nearest-neighbour KL divergence estimation — kld_est_brnn","text":"Finite sample bias reduction achieved adaptive choice number nearest neighbours. Fixing number nearest neighbours upfront, done kld_est_nn(), may result different distances \\(\\rho^l_i,\\nu^k_i\\) datapoint \\(x_i\\) \\(l\\)-th nearest neighbours \\(X\\) \\(k\\)-th nearest neighbours \\(Y\\), respectively, may lead unequal biases NN density estimation, especially high-dimensional setting. overcome issue, number neighbours \\(l,k\\) chosen way render \\(\\rho^l_i,\\nu^k_i\\) comparable, taking largest possible number neighbours \\(l_i,k_i\\) smaller \\(\\delta_i:=\\max(\\rho^1_i,\\nu^1_i)\\). Since bias reduction explicitly uses samples X Y, one-sample estimation possible using method. Reference: Wang, Kulkarni Verdú, \"Divergence Estimation Multidimensional Densities Via k-Nearest-Neighbor Distances\", IEEE Transactions Information Theory, Vol. 55, . 5 (2009). DOI: https://doi.org/10.1109/TIT.2009.2016060","code":""},{"path":"https://niklhart.github.io/kldest/reference/kld_est_brnn.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Bias-reduced generalized k-nearest-neighbour KL divergence estimation — kld_est_brnn","text":"","code":"# KL-D between one or two samples from 1-D Gaussians: X <- rnorm(100) Y <- rnorm(100, mean = 1, sd = 2) q <- function(x) dnorm(x, mean = 1, sd =2) kld_gaussian(mu1 = 0, sigma1 = 1, mu2 = 1, sigma2 = 2^2) #> [1] 0.4431472 kld_est_nn(X, Y) #> [1] 0.5070548 kld_est_nn(X, q = q) #> [1] 0.3895397 kld_est_nn(X, Y, k = 5) #> [1] 0.5854032 kld_est_nn(X, q = q, k = 5) #> [1] 0.4390202 kld_est_brnn(X, Y) #> [1] 0.4679448   # KL-D between two samples from 2-D Gaussians: X1 <- rnorm(100) X2 <- rnorm(100) Y1 <- rnorm(100) Y2 <- Y1 + rnorm(100) X <- cbind(X1,X2) Y <- cbind(Y1,Y2) kld_gaussian(mu1 = rep(0,2), sigma1 = diag(2),              mu2 = rep(0,2), sigma2 = matrix(c(1,1,1,2),nrow=2)) #> [1] 0.5 kld_est_nn(X, Y) #> [1] 0.2066204 kld_est_nn(X, Y, k = 5) #> [1] 0.1259805 kld_est_brnn(X, Y) #> [1] 0.2369476"},{"path":"https://niklhart.github.io/kldest/reference/kld_est_discrete.html","id":null,"dir":"Reference","previous_headings":"","what":"Plug-in KL divergence estimator for samples from discrete distributions — kld_est_discrete","title":"Plug-in KL divergence estimator for samples from discrete distributions — kld_est_discrete","text":"Plug-KL divergence estimator samples discrete distributions","code":""},{"path":"https://niklhart.github.io/kldest/reference/kld_est_discrete.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plug-in KL divergence estimator for samples from discrete distributions — kld_est_discrete","text":"","code":"kld_est_discrete(X, Y = NULL, q = NULL)"},{"path":"https://niklhart.github.io/kldest/reference/kld_est_discrete.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plug-in KL divergence estimator for samples from discrete distributions — kld_est_discrete","text":"X, Y n--d m--d matrices data frames, representing n samples true discrete distribution \\(P\\) m samples approximate discrete distribution \\(Q\\), d dimensions. Vector input treated column matrix. Argument Y can omitted argument q given (see ). q probability mass function approximate distribution \\(Q\\). Currently, one-sample problem implemented d=1.","code":""},{"path":"https://niklhart.github.io/kldest/reference/kld_est_discrete.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plug-in KL divergence estimator for samples from discrete distributions — kld_est_discrete","text":"scalar, estimated Kullback-Leibler divergence \\(\\hat D_{KL}(P||Q)\\).","code":""},{"path":"https://niklhart.github.io/kldest/reference/kld_est_discrete.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plug-in KL divergence estimator for samples from discrete distributions — kld_est_discrete","text":"","code":"# 1D example, two samples X <- c(rep('M',5),rep('F',5)) Y <- c(rep('M',6),rep('F',4)) kld_est_discrete(X, Y) #> [1] 0.020411  # 1D example, one sample X <- c(rep(0,4),rep(1,6)) q <- function(x) dbinom(x, size = 1, prob = 0.5) kld_est_discrete(X, q = q) #> [1] 0.02013551"},{"path":"https://niklhart.github.io/kldest/reference/kld_est_kde.html","id":null,"dir":"Reference","previous_headings":"","what":"Kernel density-based Kullback-Leibler divergence estimation in any dimension — kld_est_kde","title":"Kernel density-based Kullback-Leibler divergence estimation in any dimension — kld_est_kde","text":"Disclaimer: function use binning /fast Fourier transform hence, extremely slow even moderate datasets. reason, exported currently.","code":""},{"path":"https://niklhart.github.io/kldest/reference/kld_est_kde.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Kernel density-based Kullback-Leibler divergence estimation in any dimension — kld_est_kde","text":"","code":"kld_est_kde(X, Y, hX = NULL, hY = NULL, rule = c(\"Silverman\", \"Scott\"))"},{"path":"https://niklhart.github.io/kldest/reference/kld_est_kde.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Kernel density-based Kullback-Leibler divergence estimation in any dimension — kld_est_kde","text":"X, Y n--d m--d matrices, representing n samples true distribution \\(P\\) m samples approximate distribution \\(Q\\), d dimensions. Vector input treated column matrix. hX, hY Positive scalars length d vectors, representing bandwidth parameters (possibly different component) density estimates \\(P\\) \\(Q\\), respectively. unspecified, heurestic specified via rule argument used. rule heuristic computing arguments hX /hY. default \"silverman\" Silverman's rule $$h_i = \\sigma_i\\left(\\frac{4}{(2+d)n}\\right)^{1/(d+4)}.$$ alternative, Scott's rule \"scott\" can used, $$h_i = \\frac{\\sigma_i}{n^{1/(d+4)}}.$$","code":""},{"path":"https://niklhart.github.io/kldest/reference/kld_est_kde.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Kernel density-based Kullback-Leibler divergence estimation in any dimension — kld_est_kde","text":"scalar, estimated Kullback-Leibler divergence \\(\\hat D_{KL}(P||Q)\\).","code":""},{"path":"https://niklhart.github.io/kldest/reference/kld_est_kde.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Kernel density-based Kullback-Leibler divergence estimation in any dimension — kld_est_kde","text":"estimation method approximates densities unknown distributions \\(P\\) \\(Q\\) kernel density estimates, using sample size- dimension-dependent bandwidth parameter Gaussian kernel. works number dimensions slow.","code":""},{"path":"https://niklhart.github.io/kldest/reference/kld_est_kde.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Kernel density-based Kullback-Leibler divergence estimation in any dimension — kld_est_kde","text":"","code":"# KL-D between two samples from 1-D Gaussians: X <- rnorm(100) Y <- rnorm(100, mean = 1, sd = 2) kld_gaussian(mu1 = 0, sigma1 = 1, mu2 = 1, sigma2 = 2^2) #> [1] 0.4431472 kld_est_kde1(X, Y) #> [1] 0.4855953 kld_est_nn(X, Y) #> [1] 0.6906359 kld_est_brnn(X, Y) #> [1] 0.6184046  # KL-D between two samples from 2-D Gaussians: X1 <- rnorm(100) X2 <- rnorm(100) Y1 <- rnorm(100) Y2 <- Y1 + rnorm(100) X <- cbind(X1,X2) Y <- cbind(Y1,Y2) kld_gaussian(mu1 = rep(0,2), sigma1 = diag(2),              mu2 = rep(0,2), sigma2 = matrix(c(1,1,1,2),nrow=2)) #> [1] 0.5 kld_est_kde2(X, Y) #> [1] 0.1531984 kld_est_nn(X, Y) #> [1] 0.7389678 kld_est_brnn(X, Y) #> [1] 0.6021331"},{"path":"https://niklhart.github.io/kldest/reference/kld_est_kde1.html","id":null,"dir":"Reference","previous_headings":"","what":"1-D kernel density-based estimation of Kullback-Leibler divergence — kld_est_kde1","title":"1-D kernel density-based estimation of Kullback-Leibler divergence — kld_est_kde1","text":"estimation method approximates densities unknown distributions \\(P\\) \\(Q\\) kernel density estimate using function 'density' package 'stats'. two-sample, one-sample problem implemented.","code":""},{"path":"https://niklhart.github.io/kldest/reference/kld_est_kde1.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"1-D kernel density-based estimation of Kullback-Leibler divergence — kld_est_kde1","text":"","code":"kld_est_kde1(X, Y, MC = FALSE, ...)"},{"path":"https://niklhart.github.io/kldest/reference/kld_est_kde1.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"1-D kernel density-based estimation of Kullback-Leibler divergence — kld_est_kde1","text":"X, Y Numeric vectors single-column matrices, representing samples true distribution \\(P\\) approximate distribution \\(Q\\), respectively. MC boolean: use Monte Carlo approximation instead numerical integration via trapezoidal rule (default: FALSE)? ... parameters passed stats::density (e.g., argument bw)","code":""},{"path":"https://niklhart.github.io/kldest/reference/kld_est_kde1.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"1-D kernel density-based estimation of Kullback-Leibler divergence — kld_est_kde1","text":"scalar, estimated Kullback-Leibler divergence \\(\\hat D_{KL}(P||Q)\\).","code":""},{"path":"https://niklhart.github.io/kldest/reference/kld_est_kde1.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"1-D kernel density-based estimation of Kullback-Leibler divergence — kld_est_kde1","text":"","code":"# KL-D between two samples from 1D Gaussians: X <- rnorm(100) Y <- rnorm(100, mean = 1, sd = 2) kld_gaussian(mu1 = 0, sigma1 = 1, mu2 = 1, sigma2 = 2^2) #> [1] 0.4431472 kld_est_kde1(X,Y) #> [1] 0.3739909 kld_est_kde1(X,Y, MC = TRUE) #> [1] 0.4350728"},{"path":"https://niklhart.github.io/kldest/reference/kld_est_kde2.html","id":null,"dir":"Reference","previous_headings":"","what":"2-D kernel density-based estimation of Kullback-Leibler divergence — kld_est_kde2","title":"2-D kernel density-based estimation of Kullback-Leibler divergence — kld_est_kde2","text":"estimation method approximates densities unknown bivariate distributions \\(P\\) \\(Q\\) kernel density estimates using function 'bkde' package 'KernSmooth'. 'KernSmooth' installed, message issued (much) slower function 'kld_est_kde' used instead.","code":""},{"path":"https://niklhart.github.io/kldest/reference/kld_est_kde2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"2-D kernel density-based estimation of Kullback-Leibler divergence — kld_est_kde2","text":"","code":"kld_est_kde2(   X,   Y,   MC = FALSE,   hX = NULL,   hY = NULL,   rule = c(\"Silverman\", \"Scott\"),   eps = 1e-05 )"},{"path":"https://niklhart.github.io/kldest/reference/kld_est_kde2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"2-D kernel density-based estimation of Kullback-Leibler divergence — kld_est_kde2","text":"X, Y n--2 m--2 matrices, representing n samples bivariate true distribution \\(P\\) m samples approximate distribution \\(Q\\), respectively. MC boolean: use Monte Carlo approximation instead numerical integration via trapezoidal rule (default: FALSE)? Currently, option implemented, .e. value TRUE results error. hX, hY Bandwidths kernel density estimates \\(P\\) \\(Q\\), respectively. default NULL means determined argument rule. rule heuristic derive parameters hX hY, default \"Silverman\", means $$h_i = \\sigma_i\\left(\\frac{4}{(2+d)n}\\right)^{1/(d+4)}.$$ eps nonnegative scalar; eps > 0, \\(Q\\) estimated mixture kernel density estimate uniform distribution computational grid. weight uniform component eps times maximum density estimate \\(Q\\). increases robustness estimator expense additional bias. Defaults eps = 1e-5.","code":""},{"path":"https://niklhart.github.io/kldest/reference/kld_est_kde2.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"2-D kernel density-based estimation of Kullback-Leibler divergence — kld_est_kde2","text":"scalar, estimated Kullback-Leibler divergence \\(\\hat D_{KL}(P||Q)\\).","code":""},{"path":"https://niklhart.github.io/kldest/reference/kld_est_kde2.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"2-D kernel density-based estimation of Kullback-Leibler divergence — kld_est_kde2","text":"","code":"# KL-D between two samples from 2-D Gaussians: X1 <- rnorm(1000) X2 <- rnorm(1000) Y1 <- rnorm(1000) Y2 <- Y1 + rnorm(1000) X <- cbind(X1,X2) Y <- cbind(Y1,Y2) kld_gaussian(mu1 = rep(0,2), sigma1 = diag(2),              mu2 = rep(0,2), sigma2 = matrix(c(1,1,1,2),nrow=2)) #> [1] 0.5 kld_est_kde2(X,Y) #> [1] 0.426829 # kld_est_kde2(X,Y, MC = TRUE)"},{"path":"https://niklhart.github.io/kldest/reference/kld_est_nn.html","id":null,"dir":"Reference","previous_headings":"","what":"k-nearest neighbour KL divergence estimator — kld_est_nn","title":"k-nearest neighbour KL divergence estimator — kld_est_nn","text":"function estimates Kullback-Leibler divergence \\(D_{KL}(P||Q)\\) two continuous distributions \\(P\\) \\(Q\\) using nearest-neighbour (NN) density estimation Monte Carlo approximation \\(D_{KL}(P||Q)\\).","code":""},{"path":"https://niklhart.github.io/kldest/reference/kld_est_nn.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"k-nearest neighbour KL divergence estimator — kld_est_nn","text":"","code":"kld_est_nn(X, Y = NULL, q = NULL, k = 1L, eps = 0, log.q = FALSE)"},{"path":"https://niklhart.github.io/kldest/reference/kld_est_nn.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"k-nearest neighbour KL divergence estimator — kld_est_nn","text":"X, Y n--d m--d matrices, representing n samples true distribution \\(P\\) m samples approximate distribution \\(Q\\), d dimensions. Vector input treated column matrix. Y can left blank q specified (see ). q density function approximate distribution \\(Q\\). Either Y q must specified. k number nearest neighbours consider NN density estimation. Larger values k generally increase bias, decrease variance estimator. Defaults k = 1. eps Error bound nearest neighbour search. value eps = 0 (default) implies exact nearest neighbour search, eps > 0 approximate nearest neighbours sought, may somewhat faster high-dimensional problems. log.q TRUE, function q log-density rather density approximate distribution \\(Q\\) (default: log.q = FALSE).","code":""},{"path":"https://niklhart.github.io/kldest/reference/kld_est_nn.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"k-nearest neighbour KL divergence estimator — kld_est_nn","text":"scalar, estimated Kullback-Leibler divergence \\(\\hat D_{KL}(P||Q)\\).","code":""},{"path":"https://niklhart.github.io/kldest/reference/kld_est_nn.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"k-nearest neighbour KL divergence estimator — kld_est_nn","text":"Input estimation sample X \\(P\\) either density function q \\(Q\\) (one-sample problem) sample Y \\(Q\\) (two-sample problem). two-sample problem, estimator Eq.(5) Wang et al. (2009). one-sample problem, asymptotic bias (expectation Gamma distribution) substracted, see Pérez-Cruz (2008), Eq.(18). References: Wang, Kulkarni Verdú, \"Divergence Estimation Multidimensional Densities Via k-Nearest-Neighbor Distances\", IEEE Transactions Information Theory, Vol. 55, . 5 (2009). Pérez-Cruz, \"Kullback-Leibler Divergence Estimation Continuous Distributions\", IEEE International Symposium Information Theory (2008).","code":""},{"path":"https://niklhart.github.io/kldest/reference/kld_est_nn.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"k-nearest neighbour KL divergence estimator — kld_est_nn","text":"","code":"# KL-D between one or two samples from 1-D Gaussians: X <- rnorm(100) Y <- rnorm(100, mean = 1, sd = 2) q <- function(x) dnorm(x, mean = 1, sd =2) kld_gaussian(mu1 = 0, sigma1 = 1, mu2 = 1, sigma2 = 2^2) #> [1] 0.4431472 kld_est_nn(X, Y) #> [1] 0.7532748 kld_est_nn(X, q = q) #> [1] 0.5465343 kld_est_nn(X, Y, k = 5) #> [1] 0.575415 kld_est_nn(X, q = q, k = 5) #> [1] 0.4331822 kld_est_brnn(X, Y) #> [1] 0.7846972   # KL-D between two samples from 2-D Gaussians: X1 <- rnorm(100) X2 <- rnorm(100) Y1 <- rnorm(100) Y2 <- Y1 + rnorm(100) X <- cbind(X1,X2) Y <- cbind(Y1,Y2) kld_gaussian(mu1 = rep(0,2), sigma1 = diag(2),              mu2 = rep(0,2), sigma2 = matrix(c(1,1,1,2),nrow=2)) #> [1] 0.5 kld_est_nn(X, Y) #> [1] 0.4749195 kld_est_nn(X, Y, k = 5) #> [1] 0.1925972 kld_est_brnn(X, Y) #> [1] 0.47538"},{"path":"https://niklhart.github.io/kldest/reference/kld_exponential.html","id":null,"dir":"Reference","previous_headings":"","what":"Analytical KL divergence for two univariate exponential distributions — kld_exponential","title":"Analytical KL divergence for two univariate exponential distributions — kld_exponential","text":"function computes \\(D_{KL}(p||q)\\), \\(p\\sim \\text{Exp}(\\lambda_1)\\) \\(q\\sim \\text{Exp}(\\lambda_2)\\), rate parametrization.","code":""},{"path":"https://niklhart.github.io/kldest/reference/kld_exponential.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Analytical KL divergence for two univariate exponential distributions — kld_exponential","text":"","code":"kld_exponential(lambda1, lambda2)"},{"path":"https://niklhart.github.io/kldest/reference/kld_exponential.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Analytical KL divergence for two univariate exponential distributions — kld_exponential","text":"lambda1 scalar (rate parameter true exponential distribution) lambda2 scalar (rate parameter approximate exponential distribution)","code":""},{"path":"https://niklhart.github.io/kldest/reference/kld_exponential.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Analytical KL divergence for two univariate exponential distributions — kld_exponential","text":"scalar (Kullback-Leibler divergence)","code":""},{"path":"https://niklhart.github.io/kldest/reference/kld_exponential.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Analytical KL divergence for two univariate exponential distributions — kld_exponential","text":"","code":"kld_exponential(lambda1 = 1, lambda2 = 2) #> [1] 0.3068528"},{"path":"https://niklhart.github.io/kldest/reference/kld_gaussian.html","id":null,"dir":"Reference","previous_headings":"","what":"Analytical KL divergence for two uni- or multivariate Gaussian distributions — kld_gaussian","title":"Analytical KL divergence for two uni- or multivariate Gaussian distributions — kld_gaussian","text":"function computes \\(D_{KL}(p||q)\\), \\(p\\sim \\mathcal{N}(\\mu_1,\\Sigma_1)\\) \\(q\\sim \\mathcal{N}(\\mu_2,\\Sigma_2)\\).","code":""},{"path":"https://niklhart.github.io/kldest/reference/kld_gaussian.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Analytical KL divergence for two uni- or multivariate Gaussian distributions — kld_gaussian","text":"","code":"kld_gaussian(mu1, sigma1, mu2, sigma2)"},{"path":"https://niklhart.github.io/kldest/reference/kld_gaussian.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Analytical KL divergence for two uni- or multivariate Gaussian distributions — kld_gaussian","text":"mu1 numeric vector (mean true Gaussian) sigma1 s.p.d. matrix (Covariance matrix true Gaussian) mu2 numeric vector (mean approximate Gaussian) sigma2 s.p.d. matrix  (Covariance matrix approximate Gaussian)","code":""},{"path":"https://niklhart.github.io/kldest/reference/kld_gaussian.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Analytical KL divergence for two uni- or multivariate Gaussian distributions — kld_gaussian","text":"scalar (Kullback-Leibler divergence)","code":""},{"path":"https://niklhart.github.io/kldest/reference/kld_gaussian.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Analytical KL divergence for two uni- or multivariate Gaussian distributions — kld_gaussian","text":"","code":"kld_gaussian(mu1 = 1, sigma1 = 1, mu2 = 1, sigma2 = 2^2) #> [1] 0.3181472 kld_gaussian(mu1 = rep(0,2), sigma1 = diag(2),                 mu2 = rep(1,2), sigma2 = matrix(c(1,0.5,0.5,1), nrow = 2)) #> [1] 0.856159"},{"path":"https://niklhart.github.io/kldest/reference/kld_uniform.html","id":null,"dir":"Reference","previous_headings":"","what":"Analytical KL divergence for two uniform distributions — kld_uniform","title":"Analytical KL divergence for two uniform distributions — kld_uniform","text":"function computes \\(D_{KL}(p||q)\\), \\(p\\sim \\text{U}(a_1,b_1)\\) \\(q\\sim \\text{U}(a_2,b_2)\\), \\(a_2<a_1<b_1<b_2\\).","code":""},{"path":"https://niklhart.github.io/kldest/reference/kld_uniform.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Analytical KL divergence for two uniform distributions — kld_uniform","text":"","code":"kld_uniform(a1, b1, a2, b2)"},{"path":"https://niklhart.github.io/kldest/reference/kld_uniform.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Analytical KL divergence for two uniform distributions — kld_uniform","text":"a1, b1 Range true uniform distribution a2, b2 Range approximate uniform distribution","code":""},{"path":"https://niklhart.github.io/kldest/reference/kld_uniform.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Analytical KL divergence for two uniform distributions — kld_uniform","text":"scalar (Kullback-Leibler divergence)","code":""},{"path":"https://niklhart.github.io/kldest/reference/kld_uniform.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Analytical KL divergence for two uniform distributions — kld_uniform","text":"","code":"kld_uniform(a1 = 0, b1 = 1, a2 = 0, b2 = 2) #> [1] 0.6931472"},{"path":"https://niklhart.github.io/kldest/reference/kldest-package.html","id":null,"dir":"Reference","previous_headings":"","what":"kldest: Sample-based estimation of Kullback-Leibler divergence — kldest-package","title":"kldest: Sample-based estimation of Kullback-Leibler divergence — kldest-package","text":"collection estimation algorithms Kullback-Leibler divergence two probability distributions, based one two samples, including uncertainty quantification. Distributions can uni- multivariate continous, discrete mixed.","code":""},{"path":[]},{"path":"https://niklhart.github.io/kldest/reference/kldest-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"kldest: Sample-based estimation of Kullback-Leibler divergence — kldest-package","text":"Maintainer: Niklas Hartung niklas.hartung@gmail.com (ORCID) [copyright holder]","code":""},{"path":"https://niklhart.github.io/kldest/reference/mvdnorm.html","id":null,"dir":"Reference","previous_headings":"","what":"Probability density function of multivariate Gaussian distribution — mvdnorm","title":"Probability density function of multivariate Gaussian distribution — mvdnorm","text":"Probability density function multivariate Gaussian distribution","code":""},{"path":"https://niklhart.github.io/kldest/reference/mvdnorm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Probability density function of multivariate Gaussian distribution — mvdnorm","text":"","code":"mvdnorm(x, mu, Sigma)"},{"path":"https://niklhart.github.io/kldest/reference/mvdnorm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Probability density function of multivariate Gaussian distribution — mvdnorm","text":"x vector length d Gaussian density evaluated. mu vector length d, mean Gaussian distribution. Sigma d--d matrix, covariance matrix Gaussian distribution.","code":""},{"path":"https://niklhart.github.io/kldest/reference/mvdnorm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Probability density function of multivariate Gaussian distribution — mvdnorm","text":"probability density \\(N(\\mu,\\Sigma)\\) evaluated x.","code":""},{"path":"https://niklhart.github.io/kldest/reference/mvdnorm.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Probability density function of multivariate Gaussian distribution — mvdnorm","text":"","code":"# 1D example mvdnorm(x = 2, mu = 1, Sigma = 2) #> [1] 0.2196956 dnorm(x = 2, mean = 1, sd = sqrt(2)) #> [1] 0.2196956 # Independent 2D example mvdnorm(x = c(2,2), mu = c(1,1), Sigma = diag(1:2)) #> [1] 0.05315991 prod(dnorm(x = c(2,2), mean = c(1,1), sd = sqrt(1:2))) #> [1] 0.05315991 # Correlated 2D example mvdnorm(x = c(2,2), mu = c(1,1), Sigma = matrix(c(2,1,1,2),nrow=2)) #> [1] 0.06584074"},{"path":"https://niklhart.github.io/kldest/reference/to_uniform_scale.html","id":null,"dir":"Reference","previous_headings":"","what":"Transform samples to uniform scale — to_uniform_scale","title":"Transform samples to uniform scale — to_uniform_scale","text":"Since Kullback-Leibler divergence scale-invariant, sample-based approximations can computed conveniently chosen scale. helper functions transforms variable way marginal distributions joint dataset \\((X,Y)\\) uniform. way, scales different variables rendered comparable, idea better performance neighbour-based methods situation.","code":""},{"path":"https://niklhart.github.io/kldest/reference/to_uniform_scale.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Transform samples to uniform scale — to_uniform_scale","text":"","code":"to_uniform_scale(X, Y)"},{"path":"https://niklhart.github.io/kldest/reference/to_uniform_scale.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Transform samples to uniform scale — to_uniform_scale","text":"X, Y n--d m--d matrices, representing n samples true distribution \\(P\\) m samples approximate distribution \\(Q\\), d dimensions. Vector input treated column matrix. Y can left blank q specified (see ).","code":""},{"path":"https://niklhart.github.io/kldest/reference/to_uniform_scale.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Transform samples to uniform scale — to_uniform_scale","text":"list fields X Y, containing transformed samples.","code":""},{"path":"https://niklhart.github.io/kldest/reference/to_uniform_scale.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Transform samples to uniform scale — to_uniform_scale","text":"","code":"# 2D example n <- 10L X <- cbind(rnorm(n, mean = 0, sd = 3),            rnorm(n, mean = 1, sd = 2)) Y <- cbind(rnorm(n, mean = 1, sd = 2),            rnorm(n, mean = 0, sd = 2)) to_uniform_scale(X, Y) #> $X #>       [,1] [,2] #>  [1,] 0.65 0.15 #>  [2,] 0.20 1.00 #>  [3,] 0.95 0.60 #>  [4,] 0.70 0.90 #>  [5,] 1.00 0.80 #>  [6,] 0.25 0.40 #>  [7,] 0.75 0.65 #>  [8,] 0.15 0.55 #>  [9,] 0.05 0.25 #> [10,] 0.30 0.10 #>  #> $Y #>       [,1] [,2] #>  [1,] 0.10 0.35 #>  [2,] 0.50 0.95 #>  [3,] 0.85 0.50 #>  [4,] 0.35 0.70 #>  [5,] 0.45 0.05 #>  [6,] 0.80 0.75 #>  [7,] 0.40 0.20 #>  [8,] 0.60 0.30 #>  [9,] 0.90 0.85 #> [10,] 0.55 0.45 #>"},{"path":"https://niklhart.github.io/kldest/reference/tr.html","id":null,"dir":"Reference","previous_headings":"","what":"Matrix trace operator — tr","title":"Matrix trace operator — tr","text":"Matrix trace operator","code":""},{"path":"https://niklhart.github.io/kldest/reference/tr.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Matrix trace operator — tr","text":"","code":"tr(M)"},{"path":"https://niklhart.github.io/kldest/reference/tr.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Matrix trace operator — tr","text":"M square matrix","code":""},{"path":"https://niklhart.github.io/kldest/reference/tr.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Matrix trace operator — tr","text":"matrix trace (scalar)","code":""},{"path":"https://niklhart.github.io/kldest/reference/trapz.html","id":null,"dir":"Reference","previous_headings":"","what":"Trapezoidal integration in d dimensions — trapz","title":"Trapezoidal integration in d dimensions — trapz","text":"Trapezoidal integration d dimensions","code":""},{"path":"https://niklhart.github.io/kldest/reference/trapz.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Trapezoidal integration in d dimensions — trapz","text":"","code":"trapz(h, fx)"},{"path":"https://niklhart.github.io/kldest/reference/trapz.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Trapezoidal integration in d dimensions — trapz","text":"h length d numeric vector grid widths. fx d-dimensional array (vector, d=1).","code":""},{"path":"https://niklhart.github.io/kldest/reference/trapz.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Trapezoidal integration in d dimensions — trapz","text":"trapezoidal approximation integral.","code":""},{"path":"https://niklhart.github.io/kldest/reference/trapz.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Trapezoidal integration in d dimensions — trapz","text":"","code":"# 1D example trapz(h = 1, fx = 1:10) #> [1] 49.5 # 2D example trapz(h = c(1,1), fx = matrix(1:10, nrow = 2)) #> [1] 22"}]
